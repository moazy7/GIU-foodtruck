<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>My Orders</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="container">
    <header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
      <div><a class="btn" href="index.html">‚Üê Back</a></div>
      <nav>
        <a class="btn" href="cart.html">Cart</a>
      </nav>
    </header>
    <h1>My Orders</h1>
    <div id="ordersArea"></div>
  </div>
  <script type="module">
    import { myOrders, orderDetails } from './js/api.js';
    const area = document.getElementById('ordersArea');
    async function load(){
      const r = await myOrders(); if(!r.ok){ area.innerText='Could not load orders (login required)'; return; }
      const orders = r.body || [];
      if(orders.length===0){ area.innerHTML='<p>No orders</p>'; return; }
      area.innerHTML = orders.map(o=>`<div class="card"><h3>Order ${o.orderId}</h3><p>Truck: ${o.truckName}</p><p>Status: ${o.orderStatus}</p><p>Total: ${o.totalPrice}</p><p><button data-id="${o.orderId}" class="btn">Details</button></p></div>`).join('');
      area.querySelectorAll('button[data-id]').forEach(b=>b.addEventListener('click', async ()=>{ const id=b.dataset.id; const r2 = await orderDetails(id); if(r2.ok) alert(JSON.stringify(r2.body,null,2)); else alert('Could not load'); }));
    }
    load();
  </script>
</body>
</html>
